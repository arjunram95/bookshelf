{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useParams}from\"react-router\";import PostForm from\"./PostForm\";import axios from\"axios\";import PostItem from\"./PostItem\";import\"./Dashboard.css\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const API_URL=\"http://localhost:5000/api/posts\";const Dashboard=()=>{const storedData=localStorage.getItem(\"user\");const parsedData=JSON.parse(storedData);const{name,token}=parsedData;const[posts,setPosts]=useState([]);const{bookId}=useParams();const getPosts=async(bookId,token)=>{try{const config={headers:{Authorization:\"Bearer \".concat(token)}};console.log(token);const response=await axios.get(\"\".concat(API_URL,\"?bookId=\").concat(bookId),config);const posts=response.data;setPosts(posts);console.log(\"posts fetched from server: \",posts);}catch(error){const message=error.response&&error.response.data&&error.response.data.message||error.message||error.toString();console.log(message);}};const handlePostChange=()=>{// This function will be passed to child components\n// and called after a post is created or deleted.\ngetPosts(bookId,token);};useEffect(()=>{getPosts(bookId,token);},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\" Welcome \",name]}),/*#__PURE__*/_jsx(\"p\",{children:\"Dashboard\"})]}),/*#__PURE__*/_jsx(PostForm,{onPostCreated:handlePostChange}),/*#__PURE__*/_jsx(\"section\",{className:\"content\",children:(posts===null||posts===void 0?void 0:posts.length)>0?/*#__PURE__*/_jsx(\"div\",{className:\"posts\",children:posts.map(post=>/*#__PURE__*/_jsx(PostItem,{post:post,bookId:bookId,onPostDeleted:handlePostChange},post._id))}):/*#__PURE__*/_jsx(\"h3\",{children:\" There are no comments yet\"})})]});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","useParams","PostForm","axios","PostItem","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","API_URL","Dashboard","storedData","localStorage","getItem","parsedData","JSON","parse","name","token","posts","setPosts","bookId","getPosts","config","headers","Authorization","concat","console","log","response","get","data","error","message","toString","handlePostChange","children","onPostCreated","className","length","map","post","onPostDeleted","_id"],"sources":["C:/Users/marju/OneDrive/Desktop/Capstone_Project/GoogleBooks/bookshelf/app/src/components/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useParams } from \"react-router\";\r\nimport PostForm from \"./PostForm\";\r\nimport axios from \"axios\";\r\nimport PostItem from \"./PostItem\";\r\nimport \"./Dashboard.css\";\r\nconst API_URL = \"http://localhost:5000/api/posts\";\r\n\r\nconst Dashboard = () => {\r\n  const storedData = localStorage.getItem(\"user\");\r\n  const parsedData = JSON.parse(storedData);\r\n  const { name, token } = parsedData;\r\n  const [posts, setPosts] = useState([]);\r\n  const { bookId } = useParams();\r\n  const getPosts = async (bookId, token) => {\r\n    try {\r\n      const config = {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      };\r\n      console.log(token);\r\n      const response = await axios.get(`${API_URL}?bookId=${bookId}`, config);\r\n      const posts = response.data;\r\n      setPosts(posts);\r\n      console.log(\"posts fetched from server: \", posts);\r\n    } catch (error) {\r\n      const message =\r\n        (error.response &&\r\n          error.response.data &&\r\n          error.response.data.message) ||\r\n        error.message ||\r\n        error.toString();\r\n      console.log(message);\r\n    }\r\n  };\r\n  const handlePostChange = () => {\r\n    // This function will be passed to child components\r\n    // and called after a post is created or deleted.\r\n    getPosts(bookId, token);\r\n  };\r\n  useEffect(() => {\r\n    getPosts(bookId, token);\r\n  }, []);\r\n  return (\r\n    <>\r\n      <section>\r\n        <h1> Welcome {name}</h1>\r\n        <p>Dashboard</p>\r\n      </section>\r\n      <PostForm onPostCreated={handlePostChange} />\r\n\r\n      <section className=\"content\">\r\n        {posts?.length > 0 ? (\r\n          <div className=\"posts\">\r\n            {posts.map((post) => (\r\n              <PostItem\r\n                key={post._id}\r\n                post={post}\r\n                bookId={bookId}\r\n                onPostDeleted={handlePostChange}\r\n              />\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <h3> There are no comments yet</h3>\r\n        )}\r\n      </section>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}